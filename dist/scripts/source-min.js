var RandomFlickerImageComponent=function(e){var i=this,t=e||{pollingSecondsInterval:5};this.pollingInterval=ko.observable(t.pollingSecondsInterval),this.imageUrl=ko.observable(),this.timer=null,this.imageUrls=[],this.flickerApiKey="1b32f0e9fbf2d2ce345e5c736fa1dc75",i.initialize()};RandomFlickerImageComponent.prototype={initialize:function(){this.pollingInterval(1e3*this.pollingInterval()),this.refreshImage(),this.startTimer()},startTimer:function(){var e=this;this.timer=setInterval(function(){e.refreshImage()},e.pollingInterval())},refreshImage:function(){this.imageUrl(this.getNextAvailableImageUrl())},retrieveImages:function(){var e=this,i="https://api.flickr.com/services/rest/?method=flickr.photos.getRecent&api_key="+this.flickerApiKey+"&format=json&nojsoncallback=1";$.getJSON(i).done(function(i){e.processImageData(i)}).fail(function(){console.log("image retrieve failed! Check API flicker Key.")})},processImageData:function(e){if(this.imageUrls=[],e&&e.photos&&Array.isArray(e.photos.photo))for(var i=e.photos.photo,t=0;t<i.length;t++)this.imageUrls.push(this.composeImageUrl(i[t]))},getNextAvailableImageUrl:function(){var e="placeholder.jpg";return this.imageUrls.length?e=this.imageUrls.splice(0,1)[0]:this.retrieveImages(),e},composeImageUrl:function(e){if(!e)return"";var i=["http://farm",e.farm,".static.flickr.com/",e.server,"/",e.id,"_",e.secret,".jpg"];return i.join("")}},ko.components.register("random-flicker-image",{viewModel:RandomFlickerImageComponent,template:'<div class="random-flicker-image"><img data-bind="attr: { src: imageUrl }"/></div>'});